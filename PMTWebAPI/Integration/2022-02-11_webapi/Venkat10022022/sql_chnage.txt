alter proc [dbo].[dbsync_JointInspectionAddorUpdate]  @inspectionUid uniqueidentifier,  @BOQUid uniqueidentifier,  @DiaPipe nvarchar(200),  @unit nvarchar(50),  @invoice_number nvarchar(100),  @invoicedate datetime,  @quantity nvarchar(50),  @Inspection_Type varchar(50),  @Chainage_Number varchar(50),  @Chainage_Desc varchar(1000),  @Chainage_StartPoint decimal(18,2),  @Chainage_Length decimal(18,2),  @Qty_in_RMT decimal(18,2),  @Qty_for_Unit decimal(18,2),  @Deduction decimal(18,2),  @Remarks varchar(Max),  @PipeNumber varchar(50),  @ProjectUID uniqueidentifier,  @ServerCopiedAdd varchar(10)  as  begin  if not exists(select inspectionUid from JointInspection where inspectionUid=@inspectionUid)  begin   if @Inspection_Type='Execution' or @Inspection_Type='Laying & Jointing'   begin    insert into JointInspection(inspectionUid,DiaPipe,unit,invoice_number,invoicedate,quantity,BOQUid,Inspection_Type,Chainage_Number,Chainage_Desc,Chainage_StartPoint,Chainage_Length,Remarks,PipeNumber,ProjectUID,ServerCopiedAdd)    values(@inspectionUid,@diaPipe,@unit,@invoice_number,@invoiceDate,@Quantity,@boqUid,@Inspection_Type,@Chainage_Number,@Chainage_Desc,@Chainage_StartPoint,@Chainage_Length,@Remarks,@PipeNumber,@ProjectUID,@ServerCopiedAdd)   end   else if @Inspection_Type='Guniting' or @Inspection_Type='Epoxy'   begin    insert into JointInspection(inspectionUid,DiaPipe,unit,invoice_number,invoicedate,quantity,BOQUid,Inspection_Type,Qty_in_RMT,Qty_for_Unit,Deduction,Remarks,PipeNumber,ProjectUID,ServerCopiedAdd)    values(@inspectionUid,@diaPipe,@unit,@invoice_number,@invoiceDate,@Quantity,@boqUid,@Inspection_Type,@Qty_in_RMT,@Qty_for_Unit,@Deduction,@Remarks,@PipeNumber,@ProjectUID,@ServerCopiedAdd)   end   else   begin    insert into JointInspection(inspectionUid,DiaPipe,unit,invoice_number,invoicedate,quantity,BOQUid,Inspection_Type,Remarks,ProjectUID,ServerCopiedAdd)    values(@inspectionUid,@diaPipe,@unit,@invoice_number,@invoiceDate,@Quantity,@boqUid,@Inspection_Type,@Remarks,@ProjectUID,@ServerCopiedAdd)   end  end  else  begin   if @Inspection_Type='Execution'   begin    update JointInspection set DiaPipe=@DiaPipe,unit=@unit,quantity=@quantity,Chainage_Number=@Chainage_Number,Chainage_Desc=@Chainage_Desc,Chainage_StartPoint=@Chainage_StartPoint,Chainage_Length=@Chainage_Length,Remarks=@Remarks where inspectionUid=@inspectionUid;   end   else if @Inspection_Type='Guniting' or @Inspection_Type='Epoxy'   begin    update JointInspection set DiaPipe=@DiaPipe,unit=@unit,quantity=@quantity,Qty_in_RMT=@Qty_in_RMT,Qty_for_Unit=@Qty_for_Unit,Deduction=@Deduction,Remarks=@Remarks where inspectionUid=@inspectionUid;   end   else   begin    update JointInspection set DiaPipe=@DiaPipe,unit=@unit,quantity=@quantity,invoice_number=@invoice_number,invoicedate=@invoicedate,Remarks=@Remarks where inspectionUid=@inspectionUid;   end     update JointInspection set ServerCopiedUpdate='Y' where inspectionUid=@inspectionUid;  end  end